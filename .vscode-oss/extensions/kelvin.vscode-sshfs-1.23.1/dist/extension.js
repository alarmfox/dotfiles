(()=>{"use strict";var e,n,t,o={8065:(e,n,t)=>{t.d(n,{g3:()=>p,ok:()=>E,vj:()=>S,iE:()=>b,G_:()=>m,z0:()=>A,O1:()=>v,x3:()=>C,rF:()=>$});var o,r=t(5747);function i(e){return 32===e||9===e||11===e||12===e||160===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function a(e){return 10===e||13===e||8232===e||8233===e}function s(e){return e>=48&&e<=57}function c(e,n,t){void 0===t&&(t=o.DEFAULT);var r=function(e,n){void 0===n&&(n=!1);var t=e.length,o=0,r="",c=0,l=16,u=0,f=0,d=0,h=0,g=0;function m(n,t){for(var r=0,i=0;r<n||!t;){var a=e.charCodeAt(o);if(a>=48&&a<=57)i=16*i+a-48;else if(a>=65&&a<=70)i=16*i+a-65+10;else{if(!(a>=97&&a<=102))break;i=16*i+a-97+10}o++,r++}return r<n&&(i=-1),i}function p(){if(r="",g=0,c=o,f=u,h=d,o>=t)return c=t,l=17;var n=e.charCodeAt(o);if(i(n)){do{o++,r+=String.fromCharCode(n),n=e.charCodeAt(o)}while(i(n));return l=15}if(a(n))return o++,r+=String.fromCharCode(n),13===n&&10===e.charCodeAt(o)&&(o++,r+="\n"),u++,d=o,l=14;switch(n){case 123:return o++,l=1;case 125:return o++,l=2;case 91:return o++,l=3;case 93:return o++,l=4;case 58:return o++,l=6;case 44:return o++,l=5;case 34:return o++,r=function(){for(var n="",r=o;;){if(o>=t){n+=e.substring(r,o),g=2;break}var i=e.charCodeAt(o);if(34===i){n+=e.substring(r,o),o++;break}if(92!==i){if(i>=0&&i<=31){if(a(i)){n+=e.substring(r,o),g=2;break}g=6}o++}else{if(n+=e.substring(r,o),++o>=t){g=2;break}switch(e.charCodeAt(o++)){case 34:n+='"';break;case 92:n+="\\";break;case 47:n+="/";break;case 98:n+="\b";break;case 102:n+="\f";break;case 110:n+="\n";break;case 114:n+="\r";break;case 116:n+="\t";break;case 117:var s=m(4,!0);s>=0?n+=String.fromCharCode(s):g=4;break;default:g=5}r=o}}return n}(),l=10;case 47:var p=o-1;if(47===e.charCodeAt(o+1)){for(o+=2;o<t&&!a(e.charCodeAt(o));)o++;return r=e.substring(p,o),l=12}if(42===e.charCodeAt(o+1)){o+=2;for(var C=t-1,v=!1;o<C;){var y=e.charCodeAt(o);if(42===y&&47===e.charCodeAt(o+1)){o+=2,v=!0;break}o++,a(y)&&(13===y&&10===e.charCodeAt(o)&&o++,u++,d=o)}return v||(o++,g=1),r=e.substring(p,o),l=13}return r+=String.fromCharCode(n),o++,l=16;case 45:if(r+=String.fromCharCode(n),++o===t||!s(e.charCodeAt(o)))return l=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=function(){var n=o;if(48===e.charCodeAt(o))o++;else for(o++;o<e.length&&s(e.charCodeAt(o));)o++;if(o<e.length&&46===e.charCodeAt(o)){if(!(++o<e.length&&s(e.charCodeAt(o))))return g=3,e.substring(n,o);for(o++;o<e.length&&s(e.charCodeAt(o));)o++}var t=o;if(o<e.length&&(69===e.charCodeAt(o)||101===e.charCodeAt(o)))if((++o<e.length&&43===e.charCodeAt(o)||45===e.charCodeAt(o))&&o++,o<e.length&&s(e.charCodeAt(o))){for(o++;o<e.length&&s(e.charCodeAt(o));)o++;t=o}else g=3;return e.substring(n,t)}(),l=11;default:for(;o<t&&w(n);)o++,n=e.charCodeAt(o);if(c!==o){switch(r=e.substring(c,o)){case"true":return l=8;case"false":return l=9;case"null":return l=7}return l=16}return r+=String.fromCharCode(n),o++,l=16}}function w(e){if(i(e)||a(e))return!1;switch(e){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}return{setPosition:function(e){o=e,r="",c=0,l=16,g=0},getPosition:function(){return o},scan:n?function(){var e;do{e=p()}while(e>=12&&e<=15);return e}:p,getToken:function(){return l},getTokenValue:function(){return r},getTokenOffset:function(){return c},getTokenLength:function(){return o-c},getTokenStartLine:function(){return f},getTokenStartCharacter:function(){return c-h},getTokenError:function(){return g}}}(e,!1);function c(e){return e?function(){return e(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter())}:function(){return!0}}function l(e){return e?function(n){return e(n,r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter())}:function(){return!0}}var u=c(n.onObjectBegin),f=l(n.onObjectProperty),d=c(n.onObjectEnd),h=c(n.onArrayBegin),g=c(n.onArrayEnd),m=l(n.onLiteralValue),p=l(n.onSeparator),w=c(n.onComment),C=l(n.onError),v=t&&t.disallowComments,y=t&&t.allowTrailingComma;function $(){for(;;){var e=r.scan();switch(r.getTokenError()){case 4:S(14);break;case 5:S(15);break;case 3:S(13);break;case 1:v||S(11);break;case 2:S(12);break;case 6:S(16)}switch(e){case 12:case 13:v?S(10):w();break;case 16:S(1);break;case 15:case 14:break;default:return e}}}function S(e,n,t){if(void 0===n&&(n=[]),void 0===t&&(t=[]),C(e),n.length+t.length>0)for(var o=r.getToken();17!==o;){if(-1!==n.indexOf(o)){$();break}if(-1!==t.indexOf(o))break;o=$()}}function b(e){var n=r.getTokenValue();return e?m(n):f(n),$(),!0}return $(),17===r.getToken()?!!t.allowEmptyContent||(S(4,[],[]),!1):function e(){switch(r.getToken()){case 3:return function(){h(),$();for(var n=!1;4!==r.getToken()&&17!==r.getToken();){if(5===r.getToken()){if(n||S(4,[],[]),p(","),$(),4===r.getToken()&&y)break}else n&&S(6,[],[]);e()||S(4,[],[4,5]),n=!0}return g(),4!==r.getToken()?S(8,[4],[]):$(),!0}();case 1:return function(){u(),$();for(var n=!1;2!==r.getToken()&&17!==r.getToken();){if(5===r.getToken()){if(n||S(4,[],[]),p(","),$(),2===r.getToken()&&y)break}else n&&S(6,[],[]);(10!==r.getToken()?(S(3,[],[2,5]),0):(b(!1),6===r.getToken()?(p(":"),$(),e()||S(4,[],[2,5])):S(5,[],[2,5]),1))||S(4,[],[2,5]),n=!0}return d(),2!==r.getToken()?S(7,[2],[]):$(),!0}();case 10:return b(!0);default:return function(){switch(r.getToken()){case 11:var e=r.getTokenValue(),n=Number(e);isNaN(n)&&(S(2),n=0),m(n);break;case 7:m(null);break;case 8:m(!0);break;case 9:m(!1);break;default:return!1}return $(),!0}()}}()?(17!==r.getToken()&&S(9,[],[]),!0):(S(4,[],[]),!1)}!function(e){e.DEFAULT={allowTrailingComma:!1}}(o||(o={}));var l=t(7549),u=t(7785),f=t(9425),d=t(9104);const h=f.zW.scope(void 0,!1);h.warning.options={},h.error.options={};let g=[];function m(){return g}const p=[];async function w(e,n=!1){const t=await(0,d.Vi)((n=>(0,r.readFile)(e,n))).catch((e=>e));if(t instanceof Error)return"ENOENT"!==t.code||n?(h.error`Error while reading config file ${e}: ${t}`,[]):[];const i=[],a=function(e,n,t){void 0===n&&(n=[]),void 0===t&&(t=o.DEFAULT);var r=null,i=[],a=[];function s(e){Array.isArray(i)?i.push(e):null!==r&&(i[r]=e)}return c(e,{onObjectBegin:function(){var e={};s(e),a.push(i),i=e,r=null},onObjectProperty:function(e){r=e},onObjectEnd:function(){i=a.pop()},onArrayBegin:function(){var e=[];s(e),a.push(i),i=e,r=null},onArrayEnd:function(){i=a.pop()},onLiteralValue:s,onError:function(e,t,o){n.push({error:e,offset:t,length:o})}},t),i[0]}(t.toString(),i);return!a||i.length?(h.error`Couldn't parse ${e} as a 'JSON with Comments' file`,l.window.showErrorMessage(`Couldn't parse ${e} as a 'JSON with Comments' file`),[]):(a.forEach((n=>n._locations=[n._location=e])),h.debug`Read ${a.length} configs from ${e}`,a)}async function C(){h.info("Loading configurations..."),await async function(){const e=l.workspace.getConfiguration("sshfs"),n=e.inspect("configs");let t=0;const o=[...n.globalValue||[],...n.workspaceValue||[],...n.workspaceFolderValue||[]];function r(n,r){if(!n)return;let i=!0;return n.forEach((e=>{e.name||([e.name,t]=function(e,n=0){let t=n?`unnamed${n}`:"unnamed";for(;e.find((e=>e.name===t));)t=`unnamed${n+=1}`;return[t,n+1]}(o,t),h.warning(`Renamed unnamed config to ${e.name}`),i=!1)})),i?void 0:e.update("configs",n,r).then((()=>{}),(e=>h.error`Error while saving configs (CT=${r}): ${e}`))}await r(n.globalValue,l.ConfigurationTarget.Global),await r(n.workspaceValue,l.ConfigurationTarget.Workspace),await r(n.workspaceFolderValue,l.ConfigurationTarget.WorkspaceFolder)}();const e={folder:[],workspace:[],global:[]},n=l.workspace.getConfiguration("sshfs"),t={workspace:[],global:[]};if(n){const o=n.inspect("configs");e.workspace=o.workspaceValue||[],e.global=o.globalValue||[],e.workspace.forEach((e=>e._locations=[e._location=l.ConfigurationTarget.Workspace])),e.global.forEach((e=>e._locations=[e._location=l.ConfigurationTarget.Global]));const r=n.inspect("configpaths");t.workspace=r.workspaceValue||[],t.global=r.globalValue||[]}for(const n of t.workspace)e.workspace=[...e.workspace,...await w(n,!0)];for(const n of t.global)e.global=[...e.global,...await w(n,!0)];const o=[...e.folder,...e.workspace,...e.global];o.forEach((e=>e.name=(e.name||"").toLowerCase()));for(const e of o)e.name?(0,u.WP)(e.name)&&(h.warning(`Found a SSH FS config with the invalid name "${e.name}", prompting user how to handle`),l.window.showErrorMessage(`Invalid SSH FS config name: ${e.name}`,"Rename","Delete","Skip").then((async n=>{if("Rename"===n){const n=await l.window.showInputBox({prompt:`New name for: ${e.name}`,validateInput:u.WP,placeHolder:"New name"});if(n){const t=e.name;return h.info`Renaming config "${t}" to "${n}"`,e.name=n,$(e,t)}}else if("Delete"===n)return S(e);h.warning`Skipped SSH FS config '${e.name}'`,l.window.showWarningMessage(`Skipped SSH FS config '${e.name}'`)}))):(h.error`Skipped an invalid SSH FS config (missing a name field):\n${e}`,l.window.showErrorMessage("Skipped an invalid SSH FS config (missing a name field)"));return o.filter((e=>!(0,u.WP)(e.name)))}async function v(){const e=await C(),n=[];for(const t of e){const e=n.find((e=>e.name===t.name));e?e.merge?(h.debug`\tMerging duplicate ${t.name} from ${t._locations}`,e._locations=[...e._locations,...t._locations],Object.assign(e,Object.assign(t,e))):h.debug`\tIgnoring duplicate ${t.name} from ${t._locations}`:(h.debug`\tAdded configuration ${t.name} from ${t._locations}`,n.push(t))}return g=n,h.info`Found ${g.length} configurations`,p.forEach((e=>e(g))),g}async function y(e,n){switch(e){case l.ConfigurationTarget.Global:case l.ConfigurationTarget.Workspace:case l.ConfigurationTarget.WorkspaceFolder:const t=l.workspace.getConfiguration("sshfs"),o=t.inspect("configs");let r=n([,o.globalValue,o.workspaceValue,o.workspaceFolderValue][e]||[]);if(!r)return;return r=r.map((e=>{const n={...e};for(const t in e)"_"===t[0]&&delete n[t];return n})),await t.update("configs",r,e),void h.debug`\tUpdated configs in ${[,"Global","Workspace","WorkspaceFolder"][e]} settings.json`}if("string"!=typeof e)throw new Error(`Invalid _location field: ${e}`);let t=n(await w(e,!0));if(!t)return;t=t.map((e=>{const n={...e};for(const t in e)"_"===t[0]&&delete n[t];return n}));const o=JSON.stringify(t,null,4);await(0,d.Vi)((n=>(0,r.writeFile)(e,o,n))).catch((n=>{throw h.error`Error while writing configs to ${e}: ${n}`,n})),h.debug`\tWritten modified configs to ${e}`,await v()}async function $(e,n=e.name){const{name:t,_location:o}=e;if(!t)throw new Error("The given config has no name field");if(!o)throw new Error("The given config has no _location field");h.info`Saving config ${t} to ${o}`,n!==e.name&&h.debug`\tSaving ${t} will try to overwrite old config ${n}`,await y(o,(t=>{h.debug`\tConfig location '${o}' has following configs: ${t.map((e=>e.name)).join(", ")}`;const r=t.findIndex((e=>!!e.name&&e.name.toLowerCase()===n.toLowerCase()));return-1===r?(h.debug`\tAdding the new config to the existing configs`,t.push(e)):(h.debug`\tOverwriting config '${t[r].name}' at index ${r} with the new config`,t[r]=e),t}))}async function S(e){const{name:n,_location:t}=e;if(!n)throw new Error("The given config has no name field");if(!t)throw new Error("The given config has no _location field");h.info`Deleting config ${n} in ${t}`,await y(t,(e=>{h.debug`\tConfig location '${t}' has following configs: ${e.map((e=>e.name)).join(", ")}`;const o=e.findIndex((e=>!!e.name&&e.name.toLowerCase()===n.toLowerCase()));if(-1===o)throw new Error(`Config '${n}' not found in ${t}`);return h.debug`\tDeleting config '${e[o].name}' at index ${o}`,e.splice(o,1),e}))}function b(e){const n=e.toLowerCase(),t=m().find((e=>e.name.toLowerCase()===n));if(t)return t;if(!e.includes("@"))return;const o=(0,u.Xh)(e);if("string"==typeof o)return;const[r]=o,i=m().find((e=>e.name.toLowerCase()===r.host.toLowerCase()));return i?(f.zW.info`getConfig('${e}') led to '${r.name}' which matches config '${i.name}'`,{...i,...r,host:i.host||r.host,_location:void 0,_locations:[...i._locations,...r._locations]}):r}function k(e,n){if(typeof e!=typeof n)return!1;if("object"!=typeof e)return e===n;if(!e||!n)return e===n;if(Array.isArray(e))return!!Array.isArray(n)&&e.length===n.length&&e.every(((e,t)=>k(e,n[t])));const t=Object.keys(e),o=Object.keys(n);if(t.length!==o.length)return!1;for(const o of t)if(!k(e[o],n[o]))return!1;return!0}function E(e,n){return k(e,n)}function T(e,n){if(void 0===e)return{};if(!Array.isArray(e))throw new Error(`Expected string array for flags, but got: ${e}`);const t={};for(const o of e){let e=o,r=null;const i=o.indexOf("=");-1!==i?(e=o.substring(0,i),r=o.substring(i+1)):o.startsWith("+")?(e=o.substring(1),r=!0):o.startsWith("-")&&(e=o.substring(1),r=!1),e=e.toLocaleLowerCase(),e in t||(t[e]=[r,n])}return t}l.workspace.onDidChangeConfiguration((async e=>v())),v();const F=[];let O={};function D(){var e;const n={},t=l.workspace.getConfiguration("sshfs").inspect("flags");if(!t)throw new Error('Could not inspect "sshfs.flags" config field');const o=(e,t)=>Object.assign(n,T(e,t));return o(F,"Built-in Default"),o(t.defaultValue,"Default Settings"),(null===(e=process.versions.electron)||void 0===e?void 0:e.match(/^11\.(0|1|2)\./))&&o(["+DF-GE"],"Fix for issue #239"),o(t.globalValue,"Global Settings"),o(t.workspaceValue,"Workspace Settings"),o(t.workspaceFolderValue,"WorkspaceFolder Settings"),f.zW.info`Calculated config flags: ${n}`,O=n}function A(e,n,t){const o=function(e,n){return function(e){return{...O,...T(e,"Override")}}(n)[e.toLowerCase()]}(e,t);if(!o)return[n,"missing"];const[r,i]=o;if(null==r)return[!0,i];if("boolean"==typeof r)return[r,i];const a=r.toLowerCase();if("true"===a||"t"===a||"yes"===a||"y"===a)return[!0,i];if("false"===a||"f"===a||"no"===a||"n"===a)return[!1,i];throw new Error(`Could not convert '${r}' for flag '${e}' to a boolean!`)}l.workspace.onDidChangeConfiguration((e=>{e.affectsConfiguration("sshfs.flags")&&D()})),D()},7785:(e,n,t)=>{function o(e){const n=[1,2];for(const{_location:t}of e)t&&(n.find((e=>e===t))||n.push(t));return n}function r(e,n=!1){const t=[];function o(e){t.find((n=>n===e))||t.push(e)}for(const{group:t}of e){if(!t)continue;const e=n?t.split("."):[t];e.forEach(((n,t)=>o([...e.slice(0,t),n].join("."))))}return t}function i(e){return"object"==typeof e&&"string"==typeof e.name&&Array.isArray(e._locations)}function a(e){return e?e.match(/^[\w_\\/.@\-+]+$/)?null:"A SSH FS name can only exists of lowercase alphanumeric characters, slashes and any of these: _.+-@":"Missing a name for this SSH FS"}t.d(n,{JC:()=>o,jA:()=>r,AD:()=>i,WP:()=>a,Xh:()=>c});const s=/^((?<user>[\w\-._]+)?(;[\w-]+=[\w\d-]+(,[\w\d-]+=[\w\d-]+)*)?@)?(?<host>[^\s@\\/:,=]+)(:(?<port>\d+))?(?<path>\/\S*)?$/;function c(e){const n=(e=e.trim()).match(s);if(!n)return'Invalid format, expected something like "user@example.com:22/some/path"';const{user:t,host:o,path:r}=n.groups,i=n.groups.port,a=i?Number.parseInt(i):void 0;return i&&(!a||a<1||a>65535)?`The string '${a}' is not a valid port number`:[{name:`${t||""}@${o}${a?`:${a}`:""}${r||""}`,host:o,port:a,instantConnection:!0,username:t||"$USERNAME",_locations:[]},r]}},9425:(e,n,t)=>{t.d(n,{eM:()=>i,ew:()=>a,j7:()=>c,_$:()=>l,RS:()=>f,zW:()=>h});var o=t(7549),r=t(7785);let i=!1;function a(e){if(console.warn(`[vscode-sshfs] Debug mode set to ${e}`),i=e,e){try{t(7737).setup()}catch(e){console.warn("Could not set up .pnp.cjs:",e)}try{t(7748).install()}catch(e){console.warn("Could not install source-map-support:",e)}}}const s=o.window.createOutputChannel("SSH FS"),c={callStacktrace:0},l={callStacktrace:1};class u{constructor(e,n=!1){var t;if(this.name=e,this.defaultLoggingOptions={reportedFromLevel:0,callStacktrace:0,callStacktraceOffset:0,maxErrorStack:0},this.debug=this.wrapType("DEBUG"),this.info=this.wrapType("INFO"),this.warning=this.wrapType("WARNING",{callStacktrace:3,reportedFromLevel:2}),this.error=this.wrapType("ERROR",{callStacktrace:5,reportedFromLevel:2,maxErrorStack:10}),n){const e="number"==typeof n?n:1,o=null===(t=(new Error).stack)||void 0===t?void 0:t.split("\n").slice(3,3+e).join("\n");this.stack=o||"<stack unavailable>"}}doPrint(e,n,t){const{reportedFromLevel:o}=t,r=this.name?`[${this.name}] `:"";let a="";if(this.name&&this.stack&&o>=2?a=`\nReported by logger ${this.name}:\n${this.stack}`:this.name&&o>=1?a=`\nReported by logger ${this.name}`:this.stack&&o>=2?a=`\nReported by logger:\n${this.stack}`:this.stack&&1===o&&(a=`\nReported by logger:\n${this.stack.split("\n",2)[0]}`),this.parent)return this.parent.doPrint(e,`${r}${n}${a}`,t);const c=`[${e}]${" ".repeat(Math.max(0,8-e.length))}${r}${n}${a}`;s.appendLine(c),i&&(console[e.toLowerCase()]||console.log).call(console,c)}formatValue(e,n){var t,i;if("string"==typeof e)return e;if(e instanceof Error&&e.stack){let o=`${e.name}: ${e.message}`;try{const n=JSON.stringify(e);"{}"!==n&&(o+=`\nJSON: ${n}`)}finally{}const{maxErrorStack:r}=n;if(e.stack&&r){let{stack:n}=e;r>0&&(n=n.split(/\n/g).slice(0,r+1).join("\n")),o+="\n"+n}if(0!==r)for(let n=e;"promiseCause"in(i=n)&&i.promiseCause instanceof Error;n=n.promiseCause){let e=null===(t=n.promiseCause.stack)||void 0===t?void 0:t.split(/\n/g);e&&(r>0&&(e=e.slice(1,r+1)),o+=`\nCaused by ${n.promiseCauseName||"promise"}:\n${e.join("\n")}`)}return o}if(e instanceof o.Uri)return e.toString();if((0,r.AD)(e))return JSON.stringify(d(e),null,4);try{const n=JSON.stringify(e);return n.length<100?n:JSON.stringify(e,null,4)}catch(n){try{return`${e}`}catch(e){return`[Error formatting value: ${e.message||e}]`}}}print(e,n,t){const o={...this.defaultLoggingOptions,...t};n=this.formatValue(n,o);const{callStacktrace:r,callStacktraceOffset:i=0}=o;if(r){let e=(new Error).stack,t=e&&e.split("\n");t=t&&t.slice(i+3,r>0?i+3+r:void 0),e=t?t.join("\n"):"<stack unavailable>",n+=`\nLogged at:\n${e}`}this.doPrint(e.toUpperCase(),n,o)}printTemplate(e,n,t,o){const r={...this.defaultLoggingOptions,...o};r.callStacktraceOffset=(r.callStacktraceOffset||0)+1,this.print(e,n.reduce(((e,n,o)=>e+n+this.formatValue(t[o]||"",r)),""),o)}scope(e,n=!1){const t=new u(e,n);return t.parent=this,t}wrapType(e,n={}){const t=(n,...o)=>{const r={...t.options};return r.callStacktraceOffset=(r.callStacktraceOffset||0)+1,"string"==typeof n||n instanceof Error?t.logger.print(t.type,n,r):Array.isArray(n)?t.logger.printTemplate(t.type,n,o,r):void t.logger.error`Trying to log type ${e} with message=${n} and args=${o}`};return t.logger=this,t.type=e,t.options=n,t.withOptions=e=>this.wrapType(t.type,{...t.options,...e}),t}}function f(e=1,n={}){return{...n,callStacktraceOffset:(n.callStacktraceOffset||0)+e}}function d(e){return{...e,password:"string"==typeof e.password?"<censored>":e.password,passphrase:"string"==typeof e.passphrase?"<censored>":e.passphrase,privateKey:e.privateKey instanceof Buffer?`Buffer(${e.privateKey.length})`:e.privateKey,sock:e.sock?"<socket>":e.sock,_calculated:e._calculated?d(e._calculated):e._calculated}}const h=new u;h.info`
Created output channel for vscode-sshfs
When posting your logs somewhere, keep the following in mind:
  - While the logging tries to censor your passwords/passphrases/..., double check!
    Maybe you also want to censor out e.g. the hostname/IP you're connecting to.
  - If you want to report an issue regarding authentication or something else that
    seems to be more of an issue with the actual SSH2 connection, it might be handy
    to reconnect with this added to your User Settings (settings.json) first:
      "sshfs.flags": [ "DEBUG_SSH2" ],
    This will (for new connections) also enable internal SSH2 logging.
`},1051:(e,n,t)=>{t.r(n),t.d(n,{isSSHPseudoTerminal:()=>f,replaceVariables:()=>d,replaceVariablesRecursive:()=>h,createTerminal:()=>g,createTextTerminal:()=>m});var o=t(5622),r=t(7549),i=t(8065),a=t(9425),s=t(9104);const[c,l]=[480,640],u={height:c,width:l};function f(e){const n=e;return!!(n.connection&&n.status&&n.handleInput)}function d(e,n){return e.replace(/\$\{(.*?)\}/g,((e,n)=>{if(!n.startsWith("remote"))return e;const[t,i]=n.split(":"),s=()=>{var n,t;const o=null===(t=null===(n=r.window.activeTextEditor)||void 0===n?void 0:n.document)||void 0===t?void 0:t.uri;if(o&&"ssh"===o.scheme)return o;if(o)throw new Error(`Variable ${e}: Active editor is not a ssh:// file`);throw new Error(`Variable ${e} can not be resolved. Please open an editor.`)},{workspaceFolders:c=[]}=r.workspace,l=c.filter((e=>"ssh"===e.uri.scheme)),u=1===l.length?l[0]:void 0,f=()=>{var n;const{workspaceFolders:t=[]}=r.workspace;if(i){const o=null===(n=t.find((e=>e.name===i)))||void 0===n?void 0:n.uri;if(o&&"ssh"===o.scheme)return o;if(o)throw new Error(`Variable ${e}: Workspace folder '${i}' is not a ssh:// folder`);throw new Error(`Variable ${e} can not be resolved. No such folder '${i}'.`)}if(u)return u.uri;if(l.length>1)throw new Error(`Variable ${e} can not be resolved in a multi ssh:// folder workspace. Scope this variable using ':' and a workspace folder name.`);throw new Error(`Variable ${e} can not be resolved. Please open an ssh:// folder.`)};switch(t){case"remoteWorkspaceRoot":case"remoteWorkspaceFolder":return f().path;case"remoteWorkspaceRootFolderName":case"remoteWorkspaceFolderBasename":return o.basename(f().path);case"remoteFile":return s().path;case"remoteFileWorkspaceFolder":return(()=>{var n;const t=s(),o=null===(n=r.workspace.getWorkspaceFolder(t))||void 0===n?void 0:n.uri;if(o)return o;throw new Error(`Variable ${e}: can not find workspace folder of '${t}'.`)})().path;case"remoteRelativeFile":return u||i?o.relative(f().path,s().path):s().path;case"remoteRelativeFileDirname":{const e=o.dirname(s().path);if(u||i){const n=o.relative(f().path,e);return 0===n.length?".":n}return e}case"remoteFileDirname":return o.dirname(s().path);case"remoteFileExtname":return o.extname(s().path);case"remoteFileBasename":return o.basename(s().path);case"remoteFileBasenameNoExtension":{const e=o.basename(s().path);return e.slice(0,e.length-o.extname(e).length)}case"remoteFileDirnameBasename":return o.basename(o.dirname(s().path));case"remotePathSeparator":return o.posix.sep;default:const n=`Unrecognized task variable '${e}' starting with 'remote', ignoring`;return a.zW.warning(n,a.j7),r.window.showWarningMessage(n),e}}))}async function h(e,n){if("string"==typeof e)return n(e);if(Array.isArray(e))return e.map((e=>this.replaceVariablesRecursive(e,n)));if(!("object"!=typeof e||null===e||e instanceof RegExp||e instanceof Date)){const t={};for(let o in e){const r=await h(e[o],n);o=await h(o,n),t[o]=r}return t}return e}async function g(e){const{connection:n}=e,{actualConfig:t,client:o}=n,f=new r.EventEmitter,h=new r.EventEmitter,g=new r.EventEmitter;let m;const p={status:"opening",connection:n,onDidWrite:f.event,onDidClose:h.event,onDidOpen:g.event,close(){const{channel:e}=p;e&&(p.status="closed",e.signal("INT"),e.signal("SIGINT"),e.write(""),e.close(),p.channel=void 0)},async open(r){var c;f.fire(`Connecting to ${t.label||t.name}...\r\n`);try{const[c]=(0,i.z0)("WINDOWS_COMMAND_SEPARATOR",!1,t.flags),l=c?" && ":"; ";let m=[],w="$SHELL";const C=(0,s.nr)(n.environment,e.environment);if(m.push((0,s.xO)(C)),(0,i.z0)("REMOTE_COMMANDS",!1,t.flags)[0]&&(m.push('export ORIG_PROMPT_COMMAND="$PROMPT_COMMAND"'),m.push("export PROMPT_COMMAND='source /tmp/.Kelvin_sshfs PC; $ORIG_PROMPT_COMMAND'"),m.push('export OLD_ENV="$ENV"'),m.push("export ENV=/tmp/.Kelvin_sshfs")),e.command)m.push(d(e.command.replace(/$SHELL/g,w)));else{const e=(0,s.$R)(t.terminalCommand,l);let n=e?d(e.replace(/$SHELL/g,w)):w;m.push(n)}let{workingDirectory:v}=e;v=v||t.root,v&&(v=v.startsWith("~")?`~/"${v.substr(2)}"`:`"${v}"`,m.unshift(`cd ${v}`));const y={...u,cols:null==r?void 0:r.columns,rows:null==r?void 0:r.rows},$=(0,s.$R)(m,l);a.zW.debug(`Starting shell for ${n.actualConfig.name}: ${$}`);const S=await(0,s.Vi)((e=>o.exec($,{pty:y},e)));if(!S)throw new Error("Could not create remote terminal");p.channel=S,S.on("exit",h.fire),S.on("close",(()=>h.fire(0))),S.on("data",(e=>f.fire(e.toString()))),S.stderr.on("data",(e=>f.fire(e.toString()))),p.status="open",g.fire()}catch(e){f.fire(`Error starting SSH terminal:\r\n${e}\r\n`),h.fire(1),p.status="closed",null===(c=p.channel)||void 0===c||c.destroy()}},get terminal(){return m||(m=r.window.terminals.find((e=>"pty"in e.creationOptions&&e.creationOptions.pty===p)))},set terminal(e){m=e},setDimensions(e){var n;null===(n=p.channel)||void 0===n||n.setWindow(e.rows,e.columns,c,l)},handleInput(e){var n;null===(n=p.channel)||void 0===n||n.write(e)}};return p}function m(e){const n=new r.EventEmitter,t=new r.EventEmitter,o=new r.EventEmitter;return{write:n.fire.bind(n),close:t.fire.bind(t),onDidWrite:n.event,onDidClose:t.event,onDidOpen:o.event,open:()=>e&&(n.fire(e+"\r\n"),t.fire(1))}}},9104:(e,n,t)=>{t.d(n,{L0:()=>i,Vi:()=>a,Ru:()=>s,xO:()=>u,nr:()=>f,$R:()=>d});var o=t(9425);function r(e,n){return n.reduce(((e,n)=>`${e}\n\tat ${n} (${n.getFunction()})`),`${e.name||"Error"}: ${e.message||""}`)}async function i(e,n=0,t="catchingPromise"){let[i,a]=[];return new Promise(((t,s)=>{[i,a]=function(e,n){const t=Error.prepareStackTrace;let o="";return Error.prepareStackTrace=(e,i)=>{const a=(t||r)(e,i.slice(n+1));return o=(t||r)(e,i.slice(0,n+1)),a},Error.captureStackTrace(e),e.stack=e.stack,Error.prepareStackTrace=t,[o.split("\n").slice(1),e]}(new Error,n+2),o.eM&&(a.stack=a.stack.split("\n",2)[0]+i.map((e=>e.replace("at","~at"))).join("\n")+"\n"+a.stack.split("\n").slice(1).join("\n"));try{const n=e(t,s);n instanceof Promise&&n.catch(s)}catch(e){s(e)}})).catch((e=>{if(e instanceof Error){let r=e.stack;if(r){const t=r.split("\n");let a=t.indexOf(i[3]);-1!==a&&(a-=2+n,e.stack=t[0]+"\n"+t.slice(1,a).join("\n"),o.eM&&(e.stack+="\n"+t.slice(a).map((e=>e.replace("at","~at"))).join("\n")))}let s=e.promiseCause;s instanceof Error||(s=e),"promiseCause"in s||(Object.defineProperty(s,"promiseCause",{value:a,configurable:!0,enumerable:!1}),Object.defineProperty(s,"promiseCauseName",{value:t,configurable:!0,enumerable:!1}))}throw e}))}async function a(e){return i(((n,t)=>{e(((e,o)=>e?t(e):n(o)))}),2,"toPromise")}function s(e){const n=Number(e);if(!Number.isInteger(n))throw new Error(`Wanting to use non-int '${e}' as port`);if(n<0||n>65565)throw new Error(`Wanting to use port ${n} outside the 1-65565 range`);return n}const c=/^[\w-/\\]+$/;function l(e){return c.test(e)?e:`'${e.replace(/'/g,"'\\''")}'`}function u(e){return e.map((({key:e,value:n})=>`export ${l(e)}=${l(n)}`)).join("; ")}function f(e,...n){const t=[...e];for(const e of n)if(e)if(Array.isArray(e))for(const n of e){const e=t.findIndex((e=>e.key===n.key));-1===e?t.push(n):t[e]=n}else for(const[n,o]of Object.entries(e))t.push({key:n,value:o});return t}function d(e,n){if(e)return"string"==typeof e?e:e.filter((e=>e&&e.trim())).join(n)}},7737:e=>{e.exports=require("../.pnp.cjs")},2357:e=>{e.exports=require("assert")},4293:e=>{e.exports=require("buffer")},3129:e=>{e.exports=require("child_process")},6417:e=>{e.exports=require("crypto")},881:e=>{e.exports=require("dns")},8614:e=>{e.exports=require("events")},5747:e=>{e.exports=require("fs")},8605:e=>{e.exports=require("http")},7211:e=>{e.exports=require("https")},1631:e=>{e.exports=require("net")},2087:e=>{e.exports=require("os")},5622:e=>{e.exports=require("path")},7748:e=>{e.exports=require("source-map-support")},2413:e=>{e.exports=require("stream")},1669:e=>{e.exports=require("util")},7549:e=>{e.exports=require("vscode")},8761:e=>{e.exports=require("zlib")}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var t=r[e]={exports:{}};return o[e].call(t.exports,t,t.exports,i),t.exports}i.m=o,i.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return i.d(n,{a:n}),n},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var r=Object.create(null);i.r(r);var a={};e=e||[null,n({}),n([]),n(n)];for(var s=2&o&&t;"object"==typeof s&&!~e.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>t[e]));return a.default=()=>t,i.d(r,a),r},i.d=(e,n)=>{for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((n,t)=>(i.f[t](e,n),n)),[])),i.u=e=>e+".extension.js",i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t={e3f4:1},i.f.require=(e,n)=>{t[e]||(e=>{var n=e.modules,o=e.ids,r=e.runtime;for(var a in n)i.o(n,a)&&(i.m[a]=n[a]);r&&r(i);for(var s=0;s<o.length;s++)t[o[s]]=1})(require("./"+i.u(e)))};var a={};(()=>{i.r(a),i.d(a,{activate:()=>b});var e=i(7549),n=i(8065),t=i(9425);class o{constructor(n){this.manager=n,this.onDidChangeFileEmitter=new e.EventEmitter,this.onDidChangeFile=this.onDidChangeFileEmitter.event}async assertFs(e){return this.manager.getFs(e)||this.manager.createFileSystem(e.authority)}watch(n,t){return new e.Disposable((()=>{}))}async stat(e){return(await this.assertFs(e)).stat(e)}async readDirectory(e){return(await this.assertFs(e)).readDirectory(e)}async createDirectory(e){return(await this.assertFs(e)).createDirectory(e)}async readFile(e){return t.zW.debug`Reading ${e}`,(await this.assertFs(e)).readFile(e)}async writeFile(e,n,o){return t.zW.debug`Writing ${n.length} bytes to ${e}`,(await this.assertFs(e)).writeFile(e,n,o)}async delete(e,n){return t.zW.debug`Deleting ${e}`,(await this.assertFs(e)).delete(e,n)}async rename(e,n,o){t.zW.debug`Renaming ${e} to ${n}`;const r=await this.assertFs(e);if(r!==await this.assertFs(n))throw new Error("Can't rename between different SSH filesystems");return r.rename(e,n,o)}}var r=i(5622);const s=require("readline");var c=i(9104);class l{constructor(){this.onConnectionAddedEmitter=new e.EventEmitter,this.onConnectionRemovedEmitter=new e.EventEmitter,this.onConnectionUpdatedEmitter=new e.EventEmitter,this.onPendingChangedEmitter=new e.EventEmitter,this.connections=[],this.pendingConnections={},this.onConnectionAdded=this.onConnectionAddedEmitter.event,this.onConnectionRemoved=this.onConnectionRemovedEmitter.event,this.onConnectionUpdated=this.onConnectionUpdatedEmitter.event,this.onPendingChanged=this.onPendingChangedEmitter.event}getActiveConnection(e,t){return t&&this.connections.find((e=>(0,n.ok)(e.config,t)))||(t?void 0:this.connections.find((n=>n.config.name===e)))}getActiveConnections(){return[...this.connections]}getPendingConnections(){return Object.keys(this.pendingConnections).map((e=>[e,this.pendingConnections[e][1]]))}async _createCommandTerminal(n,o,i){const a=t.zW.scope(`CmdTerm(${o})`),l=await(0,c.Vi)((e=>n.shell({},e)));return l.write("echo ::sshfs:TTY:`tty`\n"),new Promise(((n,t)=>{setTimeout((()=>t(new Error("Timeout fetching command path"))),1e4);const c=s.createInterface(l.stdout);l.stdout.once("error",t),l.once("close",(()=>t())),c.on("line",(async t=>{var s;i&&a.debug("<< "+t);const[,c,l,u]=t.match(/(.*?)::sshfs:(\w+):(.*)$/)||[];if(l&&!c.endsWith("echo "))switch(l){case"TTY":a.info("Got TTY path: "+u),n(u);break;case"code":let[t,i]=u.split(":::");if(!t||!i)return void a.error`Malformed 'code' command args: ${u}`;t=t.trim(),i=i.trim(),a.info`Received command to open '${i}' while in '${t}'`;const c=i.startsWith("/")?i:r.posix.join(t,i),f=e.Uri.parse(`ssh://${o}/${c}`);try{(await e.workspace.fs.stat(f)).type&e.FileType.Directory?await e.workspace.updateWorkspaceFolders((null===(s=e.workspace.workspaceFolders)||void 0===s?void 0:s.length)||0,0,{uri:f}):await e.window.showTextDocument(f)}catch(n){if(n instanceof e.FileSystemError){if("FileNotFound"===n.code){if(a.warning(`File '${c}' not found, prompting to create empty file`),"Yes"!==await e.window.showWarningMessage(`File '${c}' not found, create it?`,{modal:!0},"Yes"))return;try{await e.workspace.fs.writeFile(f,Buffer.of())}catch(n){return a.error(n),void e.window.showErrorMessage(`Failed to create an empty file at '${c}'`)}return void await e.window.showTextDocument(f)}e.window.showErrorMessage(`Error opening ${c}: ${n.name.replace(/ \(FileSystemError\)/g,"")}`)}else e.window.showErrorMessage(`Error opening ${c}: ${n.message||n}`)}return;default:a.error`Unrecognized command ${l} with args: ${u}`}}))}))}async _createConnection(o,r){const a=t.zW.scope(`createConnection(${o},${r?"config":"undefined"})`);a.info`Creating a new connection for '${o}'`;const{createSSH:s,calculateActualConfig:l}=await i.e("14f8").then(i.bind(i,5589));if(!(r=r||(await(0,n.O1)()).find((e=>e.name===o))))throw new Error(`No configuration with name '${o}' found`);const u=await l(r);if(!u)throw new Error("Connection cancelled");const f=await s(u);if(!f)throw new Error(`Could not create SSH session for '${o}'`);a.info`Remote version: ${f._remoteVer||"N/A"}`;let d=await async function(e){var n;const t=await(0,c.Vi)((n=>e.exec('echo "::sshfs:home:`echo ~`:"',n)));let o="";return t.stdout.on("data",(e=>o+=e)),await(0,c.Vi)((e=>t.on("close",e))),o&&(null===(n=o.match(/::sshfs:home:(.*?):/))||void 0===n?void 0:n[1])||null}(f).catch((e=>e));if("string"!=typeof d){const[i]=(0,n.z0)("CHECK_HOME",!0,r.flags);if(a.error("Could not detect home directory",t.j7),i)throw d&&a.error(d),a.info("If this is expected, disable the CHECK_HOME flag with '-CHECK_HOME':"),a.info("https://github.com/SchoofsKelvin/vscode-sshfs/issues/270"),await e.window.showErrorMessage(`Couldn't detect the home directory for '${o}'`,"Okay"),new Error("Could not detect home directory");d&&a.warning(d),a.warning("The CHECK_HOME flag is disabled, default to '/' and ignore the error"),d=""}a.debug`Home path: ${d}`;const h=(0,c.nr)([],r.environment),[g,m]=(0,n.z0)("REMOTE_COMMANDS",!1,u.flags);if(g){const[e,t]=(0,n.z0)("DEBUG_REMOTE_COMMANDS",!1,u.flags),r=e?` with debug logging enabled by '${t}'`:"";a.info`Flag REMOTE_COMMANDS provided in '${m}', setting up command terminal${r}`;const i=await this._createCommandTerminal(f,o,e);h.push({key:"KELVIN_SSHFS_CMD_PATH",value:i});const s=await(0,c.Vi)((e=>f.sftp(e)));await(0,c.Vi)((e=>s.writeFile("/tmp/.Kelvin_sshfs",'\nif type code > /dev/null 2> /dev/null; then\n    return 0;\nfi\ncode() {\n    if [ "$#" -ne 1 ] || [ $1 = "help" ] || [ $1 = "--help" ] || [ $1 = "-h" ] || [ $1 = "-?" ]; then\n        echo "Usage:";\n        echo "  code <path_to_existing_file>    Will make VS Code open the file";\n        echo "  code <path_to_existing_folder>  Will make VS Code add the folder as an additional workspace folder";\n        echo "  code <path_to_nonexisting_file> Will prompt VS Code to create an empty file, then open it afterwards";\n    elif [ ! -n "$KELVIN_SSHFS_CMD_PATH" ]; then\n        echo "Not running in a terminal spawned by SSH FS? Failed to sent!"\n    elif [ -c "$KELVIN_SSHFS_CMD_PATH" ]; then\n        echo "::sshfs:code:$(pwd):::$1" >> $KELVIN_SSHFS_CMD_PATH;\n        echo "Command sent to SSH FS extension";\n    else\n        echo "Missing command shell pty of SSH FS extension? Failed to sent!"\n    fi\n}\necho "Injected \'code\' alias";\n',{mode:438},e))).catch((e=>{a.error`Failed to write profile script to /tmp/.Kelvin_sshfs:\n${e}\nDisabling REMOTE_COMMANDS flag`,u.flags=["-REMOTE_COMMANDS",...u.flags||[]]}))}a.debug`Environment: ${h}`;let p=0;const w={config:r,client:f,actualConfig:u,home:d,environment:h,terminals:[],filesystems:[],pendingUserCount:0,idleTimer:setInterval((()=>{if(p=p?p-1:0,!w.pendingUserCount&&(w.filesystems=w.filesystems.filter((e=>!e.closed&&!e.closing)),!w.filesystems.length&&!w.terminals.length))return 1!==p?p=2:void this.closeConnection(w,"Idle with no active filesystems/terminals")}),5e3)};return this.connections.push(w),this.onConnectionAddedEmitter.fire(w),w}async createConnection(e,n){const t=this.getActiveConnection(e,n);if(t)return t;let o=this.pendingConnections[e];return o||(o=[this._createConnection(e,n),n],this.pendingConnections[e]=o,this.onPendingChangedEmitter.fire(),o[0].finally((()=>{delete this.pendingConnections[e],this.onPendingChangedEmitter.fire()}))),o[0]}closeConnection(e,n){const o=this.connections.indexOf(e);-1!==o&&(n=n?`'${n}' as reason`:" no reason given",t.zW.info`Closing connection to '${e.actualConfig.name}' with ${n}`,this.connections.splice(o,1),clearInterval(e.idleTimer),this.onConnectionRemovedEmitter.fire(e),e.client.destroy())}update(e,n){null==n||n(e),this.onConnectionUpdatedEmitter.fire(e)}}var u=i(1051);function f(e){return e?"string"==typeof e?e:"client"in e?`Connection(${e.actualConfig.name})`:`FileSystemConfig(${e.name})`:"undefined"}class d{constructor(n){this.context=n,this.fileSystems=[],this.creatingFileSystems={},this.connectionManager=new l,e.workspace.onDidChangeWorkspaceFolders((n=>{const{workspaceFolders:t=[]}=e.workspace;n.removed.forEach((async e=>{if("ssh"!==e.uri.scheme)return;if(t.find((n=>n.uri.authority===e.uri.authority)))return;const n=this.fileSystems.find((n=>n.authority===e.uri.authority));n&&n.disconnect()}))}))}async createFileSystem(o,r){var a;const s=this.fileSystems.find((e=>e.authority===o));return s||((a=this.creatingFileSystems)[o]||(a[o]=(0,c.L0)((async(a,s)=>{if(r||(r=(0,n.iE)(o)),!r)throw new Error(`Couldn't find a configuration with the name '${o}'`);const c=await this.connectionManager.createConnection(o,r);this.connectionManager.update(c,(e=>e.pendingUserCount++)),r=c.actualConfig;const{getSFTP:l}=await i.e("14f8").then(i.bind(i,5589)),{SSHFileSystem:u}=await i.e("f1d0").then(i.bind(i,1845)),f=await l(c.client,c.actualConfig),d=new u(o,f,c.actualConfig);t.zW.info`Created SSHFileSystem for ${o}, reading root directory...`,this.connectionManager.update(c,(e=>e.filesystems.push(d))),this.fileSystems.push(d),delete this.creatingFileSystems[o],d.onClose((()=>{this.fileSystems=this.fileSystems.filter((e=>e!==d)),this.connectionManager.update(c,(e=>e.filesystems=e.filesystems.filter((e=>e!==d))))})),e.commands.executeCommand("workbench.files.action.refreshFilesExplorer"),this.connectionManager.update(c,(e=>e.pendingUserCount--));const[h]=(0,n.z0)("CHECK_HOME",!0,r.flags);if(h)try{const n=e.Uri.parse(`ssh://${o}/${c.home}`);if(!((await d.stat(n)).type&e.FileType.Directory))throw e.FileSystemError.FileNotADirectory(n)}catch(n){let r=`Couldn't read the home directory '${c.home}' on the server for SSH FS '${o}', this might be a sign of bad permissions`;if(n instanceof e.FileSystemError&&(r=`The home directory '${c.home}' in SSH FS '${o}' is not a directory, this might be a sign of bad permissions`),t.zW.error(n),"Okay"===await e.window.showWarningMessage(r,"Stop","Ignore"))return s(new Error("User stopped filesystem creation after unaccessible home directory error"))}return a(d)})).catch((n=>{if(!n)throw delete this.creatingFileSystems[o],this.commandDisconnect(o),n;throw t.zW.error`Error while connecting to SSH FS ${o}:\n${n}`,e.window.showErrorMessage(`Error while connecting to SSH FS ${o}:\n${n.message}`,"Retry","Configure","Ignore").then((e=>{delete this.creatingFileSystems[o],"Retry"===e?this.createFileSystem(o).catch((()=>{})):"Configure"===e?this.commandConfigure(r||o):this.commandDisconnect(o)})),n}))))}async createTerminal(n,t,o){const{createTerminal:r}=await Promise.resolve().then(i.bind(i,1051)),a=t&&"client"in t?t:await this.connectionManager.createConnection((null==t?void 0:t.name)||n,t);this.connectionManager.update(a,(e=>e.pendingUserCount++));const s=await r({connection:a,workingDirectory:(null==o?void 0:o.path)||a.actualConfig.root});s.onDidClose((()=>this.connectionManager.update(a,(e=>e.terminals=e.terminals.filter((e=>e!==s)))))),this.connectionManager.update(a,(e=>(e.terminals.push(s),e.pendingUserCount--)));const c=e.window.createTerminal({name:n,pty:s});s.terminal=c,c.show()}getActiveFileSystems(){return this.fileSystems}getFs(e){return this.fileSystems.find((n=>n.authority===e.authority))||null}async promptReconnect(t){const o=(0,n.iE)(t);o&&"Disconnect"===await e.window.showWarningMessage(`SSH FS ${o.label||o.name} disconnected`,"Ignore","Disconnect")&&this.commandDisconnect(t)}provideTasks(e){return[]}async resolveTask(o,r){return new e.Task(o.definition,e.TaskScope.Workspace,`SSH Task '${o.name}'`,"ssh",new e.CustomExecution((async e=>{const{createTerminal:o,createTextTerminal:r}=await Promise.resolve().then(i.bind(i,1051));try{if(!e.host)throw new Error("Missing field 'host' in task description");if(!e.command)throw new Error("Missing field 'command' in task description");const r=await this.connectionManager.createConnection(e.host);e=await(0,u.replaceVariablesRecursive)(e,(e=>(0,u.replaceVariables)(e,r.actualConfig)));let{command:i,workingDirectory:a}=e;const[s]=(0,n.z0)("WINDOWS_COMMAND_SEPARATOR",!1,r.actualConfig.flags),l=s?" && ":"; ";let{taskCommand:f="$COMMAND"}=r.actualConfig;if(f=(0,c.$R)(f,l),f.includes("$COMMAND"))i=f.replace(/\$COMMAND/g,i);else{const e=`The taskCommand '${f}' is missing the '$COMMAND' placeholder!`;t.zW.warning(e,t.j7),i="echo \"Missing '$COMMAND' placeholder\""}this.connectionManager.update(r,(e=>e.pendingUserCount++));const d=await o({command:i,workingDirectory:a,connection:r});return this.connectionManager.update(r,(e=>(e.pendingUserCount--,e.terminals.push(d)))),d.onDidClose((()=>this.connectionManager.update(r,(e=>e.terminals=e.terminals.filter((e=>e!==d)))))),d}catch(e){return r(`Error: ${e.message||e}`)}})))}provideTerminalLinks(n,t){const{line:o,terminal:r}=n,{creationOptions:i}=r;if(!("pty"in i))return;const{pty:a}=i;if(!(0,u.isSSHPseudoTerminal)(a))return;const s=this.connectionManager.getActiveConnections().find((e=>e.terminals.includes(a)));if(!s)return;const c=[],l=/\/\S+/g;for(;;){const n=l.exec(o);if(!n)break;let[t]=n;t.startsWith("~")&&(t=s.home+t.substring(1));const r=e.Uri.parse(`ssh://${s.actualConfig.name}/${t}`);c.push({uri:r,startIndex:n.index,length:t.length,tooltip:"[SSH FS] Open file"})}return c}async handleTerminalLink(n){n.uri&&await e.window.showTextDocument(n.uri)}async commandConnect(n){t.zW.info`Command received to connect ${n.name}`;const o=e.workspace.workspaceFolders;if(o&&o.find((e=>"ssh"===e.uri.scheme&&e.uri.authority===n.name)))return e.commands.executeCommand("workbench.files.action.refreshFilesExplorer");let{root:r="/"}=n;r.startsWith("~")&&(r=(await this.connectionManager.createConnection(n.name,n)).home+r.substring(1)),r.startsWith("/")&&(r=r.substring(1)),e.workspace.updateWorkspaceFolders(o?o.length:0,0,{uri:e.Uri.parse(`ssh://${n.name}/${r}`),name:`SSH FS - ${n.label||n.name}`})}commandDisconnect(n){let o;t.zW.info`Command received to disconnect ${f(n)}`,"object"==typeof n&&"client"in n?(o=[n],n=n.actualConfig.name):o=this.connectionManager.getActiveConnections().filter((e=>e.actualConfig.name===n));for(const e of o)this.connectionManager.closeConnection(e);const r=this.connectionManager.getActiveConnections().filter((e=>e.actualConfig.name===n));if(r&&r.some((e=>e.filesystems.length)))return;const i=e.workspace.workspaceFolders||[];let a=i.length,s=[];for(const e of i)"ssh"===e.uri.scheme&&e.uri.authority===n?a=Math.min(e.index,a):e.index>a&&s.push(e);i.length!==s.length&&e.workspace.updateWorkspaceFolders(a,i.length-a,...s)}async commandTerminal(n,o){t.zW.info`Command received to open a terminal for ${f(n)}${o?` in ${o}`:""}`;const r="client"in n?n.actualConfig:n;try{await this.createTerminal(r.label||r.name,n,o)}catch(i){t.zW.error`Error while creating terminal:\n${i}`;const a=await e.window.showErrorMessage(`Couldn't start a terminal for ${r.name}: ${i.message||i}`,{title:"Retry"},{title:"Ignore",isCloseAffordance:!0});if(a&&"Retry"===a.title)return this.commandTerminal(n,o)}}async commandConfigure(o){if(t.zW.info`Command received to configure ${"string"==typeof o?o:o.name}`,"object"==typeof o)return o._location||o._locations.length?void this.openSettings({config:o,type:"editconfig"}):void e.window.showErrorMessage("Cannot configure a config-less connection!");o=o.toLowerCase();let r=await(0,n.x3)();if(r=r.filter((e=>e.name===o)),0===r.length)return e.window.showErrorMessage(`Found no matching configs for '${o}'`),t.zW.error`Unexpectedly found no matching configs for '${o}' in commandConfigure?`;const i=1===r.length?r[0]:r;this.openSettings({config:i,type:"editconfig"})}async openSettings(e){const{open:n,navigate:t}=await i.e("5c85").then(i.bind(i,337));return e?t(e):n()}}var h=i(7785);function g(e){const{username:n,host:t,port:o}=e;return`${n?`${n}@`:""}${t}${o?`:${o}`:""}`}function m(n,t){return e.commands.executeCommand("setContext",`sshfs.${n}`,t)}let p;function w(n,t=!1){var o;if("handleInput"in n)return{item:n,contextValue:"terminal",label:`${t?"$(terminal) ":""}${(null===(o=n.terminal)||void 0===o?void 0:o.name)||"Unnamed terminal"}`,iconPath:new e.ThemeIcon("terminal"),command:{title:"Focus",command:"sshfs.focusTerminal",arguments:[n]}};if("client"in n){const{label:o,name:r,group:i}=n.config,a=i?`${i}.${r} `:o&&r,s=g(n.actualConfig);return{item:n,description:a,detail:s,tooltip:s,label:`${t?"$(plug) ":""}${o||r} `,iconPath:new e.ThemeIcon("plug"),collapsibleState:e.TreeItemCollapsibleState.Expanded,contextValue:"connection"}}if("onDidChangeFile"in n){const{label:e,name:o,group:r}=n.config;return{item:n,description:r?`${r}.${o} `:e&&o,contextValue:"filesystem",label:`${t?"$(root-folder) ":""}ssh://${n.authority}/`,iconPath:null==p?void 0:p("resources/icon.svg")}}const{label:r,name:i,group:a,putty:s}=n,c=a?`${a}.${i} `:r&&i,l=!0===s?"PuTTY session (decuded from config)":"string"==typeof s?`PuTTY session '${s}'`:g(n);return{item:n,description:c,detail:l,tooltip:l,contextValue:"config",label:`${t?"$(settings-gear) ":""}${n.label||n.name} `,iconPath:new e.ThemeIcon("settings-gear")}}async function C(n){const t=n?[n.length,n.length]:void 0,o=await e.window.showInputBox({value:n,valueSelection:t,placeHolder:"user@host:/home/user",prompt:"SSH connection string",validateInput(e){const n=(0,h.Xh)(e);return"string"==typeof n?n:void 0}});if(!o)return;const r=(0,h.Xh)(o);return"string"!=typeof r?r[0]:void 0}async function v(t,o){return new Promise((r=>{var i;const{promptConnections:a,promptConfigs:s,nameFilter:c}=o,l=[],u=[];if(a){let e=t.connectionManager.getActiveConnections();"string"==typeof a&&(e=e.filter((e=>e.actualConfig.name===a))),c&&(e=e.filter((e=>e.actualConfig.name===c))),l.push(...e.map((e=>w(e,!0)))),u.push("connection")}if(s){let e=(0,n.G_)();"string"==typeof s&&(e=e.filter((e=>e.name===s))),c&&(e=e.filter((e=>e.name===c))),l.push(...e.map((e=>w(e,!0)))),u.push("configuration")}if(o.promptTerminals){let e=t.connectionManager.getActiveConnections();"string"==typeof a&&(e=e.filter((e=>e.actualConfig.name===a))),c&&(e=e.filter((e=>e.actualConfig.name===c)));const n=e.reduce(((e,n)=>[...e,...n.terminals]),[]);l.push(...n.map((e=>w(e,!0)))),u.push("terminal")}if(o.promptInstantConnection&&l.unshift({label:"$(terminal) Create instant connection",detail:"Opens an input box where you can type e.g. `user@host:22/home/user`",picked:!0,alwaysShow:!0,item:C}),o.immediateReturn&&l.length<=1)return r(null===(i=l[0])||void 0===i?void 0:i.item);const f=e.window.createQuickPick();f.items=l,f.title="Select "+u.join(" / "),f.onDidAccept((()=>{var e;let n=null===(e=f.activeItems[0])||void 0===e?void 0:e.item;f.hide(),"function"==typeof n&&(n=n(f.value)),r(n)})),f.onDidHide((()=>r(void 0))),f.show()}))}class y{constructor(n){this.manager=n,this.onDidChangeTreeDataEmitter=new e.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,n.onConnectionAdded((()=>this.onDidChangeTreeDataEmitter.fire())),n.onConnectionRemoved((()=>this.onDidChangeTreeDataEmitter.fire())),n.onConnectionUpdated((e=>this.onDidChangeTreeDataEmitter.fire(e)))}refresh(){this.onDidChangeTreeDataEmitter.fire()}getTreeItem(n){if("onDidChangeFile"in n||"handleInput"in n)return{...w(n),collapsibleState:e.TreeItemCollapsibleState.None};if(Array.isArray(n)){const[t,o]=n;return o?{...w(o),contextValue:"pendingconnection",collapsibleState:e.TreeItemCollapsibleState.Collapsed,iconPath:new e.ThemeIcon("loading~spin")}:{label:t,description:"Connecting..."}}return{...w(n),collapsibleState:e.TreeItemCollapsibleState.Collapsed}}getChildren(e){return e?"onDidChangeFile"in e||"handleInput"in e||Array.isArray(e)?[]:[...e.terminals,...e.filesystems]:[...this.manager.getActiveConnections(),...this.manager.getPendingConnections()]}}class ${constructor(){this.onDidChangeTreeDataEmitter=new e.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,n.g3.push((()=>this.onDidChangeTreeDataEmitter.fire()))}getTreeItem(n){return"string"==typeof n?{label:n.replace(/^.+\./,""),contextValue:"group",collapsibleState:e.TreeItemCollapsibleState.Collapsed,iconPath:e.ThemeIcon.Folder}:{...w(n),collapsibleState:e.TreeItemCollapsibleState.None}}getChildren(e=""){if("string"!=typeof e)return[];const t=(0,n.G_)(),o=t.filter((({group:n})=>(n||"")===e));o.sort(((e,n)=>e.name>n.name?1:-1));let r=(0,h.jA)(t,!0);return r=e?r.filter((n=>n.startsWith(e)&&"."===n[e.length]&&!n.includes(".",e.length+1))):r.filter((e=>!e.includes("."))),[...o,...r.sort()]}}function S(){var n;const t=e.extensions.getExtension("Kelvin.vscode-sshfs");return null===(n=null==t?void 0:t.packageJSON)||void 0===n?void 0:n.version}function b(r){var i;t.zW.info`Extension activated, version ${S()}, mode ${r.extensionMode}`,(0,t.ew)("true"===(null===(i=process.env.VSCODE_SSHFS_DEBUG)||void 0===i?void 0:i.toLowerCase()));const a=r.globalState.get("lastVersion");var s;r.globalState.update("lastVersion",S()),a?a!==S()&&t.zW.info`Previously used version ${a}, first run after install.`:t.zW.info("No previous version detected. Fresh or pre-v1.21.0 installation?"),s=r.asAbsolutePath.bind(r),p=s;const c=new d(r),l=r.subscriptions.push.bind(r.subscriptions),u=(n,t,o)=>l(e.commands.registerCommand(n,t,o));l(e.workspace.registerFileSystemProvider("ssh",new o(c),{isCaseSensitive:!0})),l(e.window.createTreeView("sshfs-configs",{treeDataProvider:new $,showCollapseAll:!0}));const f=new y(c.connectionManager);function h(n,o){u(n,(async r=>{var i,a,s,l,u;return!o.promptOptions||r&&"string"!=typeof r||(r=await v(c,{...o.promptOptions,nameFilter:r})),"string"==typeof r?null===(i=o.handleString)||void 0===i?void 0:i.call(o,r):r?r instanceof e.Uri?null===(a=o.handleUri)||void 0===a?void 0:a.call(o,r):"handleInput"in r?null===(s=o.handleTerminal)||void 0===s?void 0:s.call(o,r):"client"in r?null===(l=o.handleConnection)||void 0===l?void 0:l.call(o,r):"name"in r?null===(u=o.handleConfig)||void 0===u?void 0:u.call(o,r):void t.zW.warning(`CommandHandler for '${n}' could not handle input '${r}'`):void 0}))}l(e.window.createTreeView("sshfs-connections",{treeDataProvider:f,showCollapseAll:!0})),l(e.tasks.registerTaskProvider("ssh-shell",c)),l(e.window.registerTerminalLinkProvider(c)),function(e){async function n(){const n=e.getActiveConnections(),t=e.getPendingConnections();await m("openConnections",n.length+t.length),await m("openTerminals",n.reduce(((e,n)=>e+n.terminals.length),0)),await m("openFileSystems",n.reduce(((e,n)=>e+n.filesystems.length),0))}e.onConnectionAdded(n),e.onConnectionRemoved(n),e.onConnectionUpdated(n),e.onPendingChanged(n),n()}(c.connectionManager),u("sshfs.new",(()=>c.openSettings({type:"newconfig"}))),h("sshfs.add",{promptOptions:{promptConfigs:!0,promptConnections:!0,promptInstantConnection:!0},handleConfig:e=>c.commandConnect(e)}),h("sshfs.disconnect",{promptOptions:{promptConnections:!0},handleString:e=>c.commandDisconnect(e),handleConfig:e=>c.commandDisconnect(e.name),handleConnection:e=>c.commandDisconnect(e)}),u("sshfs.disconnectAll",(()=>{const e=c.connectionManager;e.getActiveConnections().forEach((n=>e.closeConnection(n,"command:disconnectAll")))})),h("sshfs.terminal",{promptOptions:{promptConfigs:!0,promptConnections:!0,promptInstantConnection:!0},handleConfig:e=>c.commandTerminal(e),handleConnection:e=>c.commandTerminal(e),handleUri:async e=>{const n=await((e,n)=>v(e,{promptConnections:n||!0,immediateReturn:!!n}))(c,e.authority);n&&c.commandTerminal(n,e)}}),h("sshfs.focusTerminal",{promptOptions:{promptTerminals:!0},handleTerminal:({terminal:e})=>null==e?void 0:e.show(!1)}),h("sshfs.closeTerminal",{promptOptions:{promptTerminals:!0},handleTerminal:e=>e.close()}),h("sshfs.configure",{promptOptions:{promptConfigs:!0},handleConfig:e=>c.commandConfigure(e)}),u("sshfs.reload",n.O1),u("sshfs.settings",(()=>c.openSettings())),u("sshfs.refresh",(()=>f.refresh()))}})(),module.exports=a})();
//# sourceMappingURL=extension.js.map